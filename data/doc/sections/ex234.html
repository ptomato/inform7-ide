<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>18.3. New rules</title></head>
<STYLE TYPE="text/css">
<!--
.oval, .oval TD
{
background-image:url('../doc_images/ovoid.png');
color:white;
}
-->
</STYLE>
<body><font size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"><a href=doc285.html border=0><img border=0 src=../doc_images/Hookleft.png id="hookleft" style="height: 24px; width: 32px;" border=0></a></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><a href=../chap18.html STYLE="text-decoration: none"><font color="#FFFFFF" size=2>Chapter 18: Rulebooks</font></a></td><TD width=56px height=26px align="right" valign="center"><a href=../index.html border=0><img border=0 src=../doc_images/Hookup.png id="hookup" style="height: 24px; width: 24px;" border=0></a><a href=doc287.html border=0><img border=0 src=../doc_images/Hookright.png id="hookright" style="height: 24px; width: 32px;" border=0></a></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD height=8px halign="center" valign="center"></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD width=38px halign="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><font color="#000000" size="3"><b>18.3. New rules</b></font></td></tr></table>
<p>
<p>Stretching a point seasonally, we might write:
<p>
<blockquote><font color="#000080">Every turn, say &quot;The summer breeze shakes the apple-blossom.&quot;
</font></blockquote><p>
<p>
<p>This rule is nameless. It needs no name because it will never need to be referred to: by identifying it as an every turn rule we have already said enough to lodge it in the &quot;every turn rules&quot; rulebook. In fact, though, it is easy to create a named rule:
<p>
<blockquote><font color="#000080">This is the blossom shaking rule: say &quot;The summer breeze shakes the apple-blossom.&quot;
</font></blockquote><p>
<p>
<p>The name of a rule must always end with the word &quot;rule&quot;, for clarity's sake. (The phrasing &quot;This is the ... rule&quot; is used because &quot;The ... rule&quot; would be open to misinterpretation.)
<p>
<p>Previously we had a rule which had no name, but belonged to a rulebook: now we have the opposite, because although the &quot;blossom shaking rule&quot; has a name, it has not been placed in any rulebook. That means it will probably never be applied. We can remedy this like so:
<p>
<blockquote><font color="#000080">The blossom rule is listed in the every turn rules.
</font></blockquote><p>
<p>
<p>A single rule like this can be listed in any number of rulebooks, including none.
<p>
<p>Alternatively, it is possible to both name and list a rule in a single sentence:
<p>
<blockquote><font color="#000080">Every turn (this is the blossom rule): say &quot;The summer breeze shakes the apple-blossom.&quot;
</font></blockquote><p>
<p>
<p>Where rules have been named, we are able to have a say in what order they come in:
<p>
<blockquote><font color="#000080">The blossom rule is listed before the moving doorways rule in the every turn rules.
</font></blockquote><p>
<p>
<p><hr><p>
<a name="e234"><table CELLPADDING=0 CELLSPACING=0><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=doc286.html#e234 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>270</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font size=2><a href=doc286.html#e234 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;<b>Example</b>&nbsp;</font> <font color="#000000"> Stone</font></b></a><br>A soup to which the player can add ingredients, which will have different effects when the player eats.<p></td></tr></table>
<table border=0 bgcolor="#f0f0f0" width=100%><tr><td><font size=2><p>
<p>A thing can have a rule as a property, if we like. Here we are going to allow the player to make a soup whose effects will depend on its ingredients. Each ingredient will have its own &quot;food effect&quot; rule, to be followed when the food is eaten. So:
<p>
<blockquote><font color="#000080"><script language="JavaScript">
function pasteCode329(code) {
    var myProject = external.Project;

    myProject.selectView('source');
    myProject.pasteCode('"Stone"\n\nA food is a kind of thing that is edible. A food has a rule called the food effect.\n\nCarry out eating a food:\n\tif a food is part of the noun\n\tbegin;\n\t\trepeat with item running through things which are part of the noun\n\t\tbegin;\n\t\t\tif item is a food, follow the food effect of the item;\n\t\tend repeat;\n\tend if;\n\tfollow the food effect of the noun.\n\nReport eating a food:\n\tsay "You eat [the noun]. [diagnosis of the player]";\n\tstop the action.\n\nTo say diagnosis of (victim - a person):\n\tif the victim is ill\n\tbegin;\n\t\tsay "You are ill.";\n\t\trule succeeds;\n\totherwise;\n\t\tsay "You are healthy. ";\n\tend if;\n\tif the victim is awake, say "You are wide awake. ";\n\totherwise say "You are sleepy. ";\n\tif the victim is bright-eyed, say "Your eyesight is clear. ";\n\totherwise say "Your eyesight is dim. ";\n\tif the victim is weak, say "You are weak. ";\n\totherwise say "You are strong. ";\n\tif the victim is hungry, say "You are hungry.";\n\totherwise say "You are well-fed."\n\n[And now to provide some particular foods:]\n\nSome carrots are a food. The food effect of carrots is the bright-eye rule. This is the bright-eye rule: now the player is bright-eyed.\n\nSome potatoes are a food. The food effect of the potatoes is the sleepiness rule. This is the sleepiness rule: now the player is sleepy.\n\nThe broth is a food. The indefinite article of the broth is "some". The food effect of broth is the filling rule. This is the filling rule: now the player is full.\n\nThe hambone is a food. The food effect of the hambone is the heartiness rule. This is the heartiness rule: now the player is strong. Instead of eating the hambone: say "You cannot just eat a bone!"\n\nThe poison ivy is a food. "Poison ivy grows nearby." The food effect of poison is the illness rule. This is the illness rule: now the player is ill.\n\nA person can be bright-eyed or blind. The player is blind.\n\nA person can be well or ill. The player is well.\n\nA person can be hungry or full. The player is full.\n\nA person can be strong or weak. The player is weak.\n\nA person can be awake or sleepy. The player is sleepy.\n\nThe broth is in the kettle. The kettle is on the fire. The fire is in the Clearing. The Clearing is a room.\n\nThe player carries the hambone, the potatoes, and the carrots. The ivy is in the clearing.\n\nInstead of examining the broth:\n\tif something is part of the broth, say "In the broth, [a list of things that are part of the broth] float[if exactly one thing is part of the broth]s[end if].";\n\totherwise say "It is just a thin broth with no other ingredients."\n\nInstead of inserting something into the broth: try inserting the noun into the holder of the broth.\n\nInstead of taking the broth: say "You cannot take the broth in your bare hands."\n\n[And the following is a relatively unimportant nicety -- the Plurality extension provides some additional adjectives for handling objects with plural names, so we rely on it here:]\n\nInclude Plurality by Emily Short.\n\nAfter inserting a food which is not the broth into a container which contains the broth:\n\tnow the noun is part of the broth;\n\tsay "[The noun] [if the noun acts plural]sink[otherwise]sinks[end if] into [the second noun], making the broth richer."\n\nTest me with "x broth / eat hambone / put hambone in kettle / x broth / put potatoes in broth / x broth / eat carrots / eat broth / put ivy in kettle / eat ivy".\n');
}
</script>
<a href="javascript:pasteCode329()"><img border=0 src=../doc_images/paste.png></a> &quot;Stone&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A food is a kind of thing that is edible. A food has a rule called the food effect.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Carry out eating a food:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if a food is part of the noun
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat with item running through things which are part of the noun
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if item is a food, follow the food effect of the item;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end repeat;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;follow the food effect of the noun.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Report eating a food:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You eat [the noun]. [diagnosis of the player]&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;stop the action.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To say diagnosis of (victim - a person):
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the victim is ill
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You are ill.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule succeeds;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You are healthy. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the victim is awake, say &quot;You are wide awake. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise say &quot;You are sleepy. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the victim is bright-eyed, say &quot;Your eyesight is clear. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise say &quot;Your eyesight is dim. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the victim is weak, say &quot;You are weak. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise say &quot;You are strong. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the victim is hungry, say &quot;You are hungry.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise say &quot;You are well-fed.&quot;
</font></blockquote><p>
<p>
<p>And now to provide some particular foods:
<p>
<blockquote><font color="#000080">Some carrots are a food. The food effect of carrots is the bright-eye rule. This is the bright-eye rule: now the player is bright-eyed.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Some potatoes are a food. The food effect of the potatoes is the sleepiness rule. This is the sleepiness rule: now the player is sleepy.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The broth is a food. The indefinite article of the broth is &quot;some&quot;. The food effect of broth is the filling rule. This is the filling rule: now the player is full.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The hambone is a food. The food effect of the hambone is the heartiness rule. This is the heartiness rule: now the player is strong. Instead of eating the hambone: say &quot;You cannot just eat a bone!&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The poison ivy is a food. &quot;Poison ivy grows nearby.&quot; The food effect of poison is the illness rule. This is the illness rule: now the player is ill.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be bright-eyed or blind. The player is blind.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be well or ill. The player is well.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be hungry or full. The player is full.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be strong or weak. The player is weak.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be awake or sleepy. The player is sleepy.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The broth is in the kettle. The kettle is on the fire. The fire is in the Clearing. The Clearing is a room.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The player carries the hambone, the potatoes, and the carrots. The ivy is in the clearing.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of examining the broth:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if something is part of the broth, say &quot;In the broth, [a list of things that are part of the broth] float[if exactly one thing is part of the broth]s[end if].&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise say &quot;It is just a thin broth with no other ingredients.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of inserting something into the broth: try inserting the noun into the holder of the broth.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of taking the broth: say &quot;You cannot take the broth in your bare hands.&quot;
</font></blockquote><p>
<p>
<p>And the following is a relatively unimportant nicety -- the Plurality extension provides some additional adjectives for handling objects with plural names, so we rely on it here:
<p>
<blockquote><font color="#000080">Include Plurality by Emily Short.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">After inserting a food which is not the broth into a container which contains the broth:
<br>&nbsp;&nbsp;&nbsp;&nbsp;now the noun is part of the broth;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun] [if the noun acts plural]sink[otherwise]sinks[end if] into [the second noun], making the broth richer.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Test me with &quot;x broth / eat hambone / put hambone in kettle / x broth / put potatoes in broth / x broth / eat carrots / eat broth / put ivy in kettle / eat ivy&quot;.
</font></blockquote><p>
<table CELLPADDING=0 CELLSPACING=0 width="100%" height=18><tr><td width="100%"> </td><td width=18 align="left" bgcolor="#000000"><a href=doc286.html><img src=../doc_images/Hookclose.png id="hookclose" style="height: 17px; width: 17px;" border="0"></a></td><td width=4></td><td width=18 align="left" bgcolor="#000000"><a href=../recipes.html><img src=../doc_images/Hookrecipe.png id="hookrecipe" style="height: 17px; width: 17px;" border="0"></a></td><td width=4></td><td width=18 align="left" bgcolor="#000000"><a href=../examples.html><img src=../doc_images/Hookindex.png id="hookindex" style="height: 17px; width: 17px;" border="0"></a></td></tr></table></td></tr></table><p><a name="e61"><table CELLPADDING=0 CELLSPACING=0><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=ex61.html#e61 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>271</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font size=2><a href=ex61.html#e61 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000">The Crane's Leg 2</font></b></a><br>A description text generated based on the propensities of the player-character, following different rulebooks for different characters.<p></td></tr></table>
<p><hr><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td width="33%" align="left"><a href=doc285.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Previous</font></a></td><td width="33%" align="center"><a href=../index.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Contents</font></a></td><td width="33%" align="right"><a href=doc287.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Next</font></a></td></tr></table></font></body></html>
